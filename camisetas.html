<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reserva de Camisetas — Rizoma</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <a href="index.html" style="display:flex;align-items:center;gap:0.6rem;text-decoration:none;">
          <img src="assets/logo.svg" alt="Rizoma logo" class="logo" />
          <h1 class="site-title">Rizoma</h1>
        </a>
      </div>
      <nav class="nav">
        <a href="index.html#about">Quiénes somos</a>
        <a href="index.html#fiesta">La fiesta</a>
        <a href="camisetas.html">Camisetas</a>
        <a href="index.html#news">Novedades</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero" style="background:linear-gradient(180deg, rgba(255,92,122,0.06), transparent);">
      <div class="container hero-inner">
        <div class="hero-text">
          <h2 style="color:#1e1e1e;">Reserva tu Camiseta</h2>
          <p class="lead">Elige modelo, talla y cantidad. Asegúrate tu camiseta de Rizoma.</p>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <p>Personaliza tu reserva: selecciona el modelo que te guste, tu talla y la cantidad que desees. Completa el formulario y recibirás confirmación de tu pedido.</p>
        
        <div class="tshirt-form-wrapper">
          <form id="tshirtForm" class="tshirt-form">
            <!-- Selección de modelo -->
            <fieldset class="form-section">
              <legend>Modelo</legend>
              <div class="model-grid">
                <label class="model-card" data-model="modelo-1">
                  <input type="radio" name="model" value="modelo-1" required>
                  <div class="model-preview">
                    <div class="preview-front">Frente</div>
                    <div class="preview-back">Espalda</div>
                  </div>
                  <span>Modelo 1</span>
                </label>
                <label class="model-card" data-model="modelo-2">
                  <input type="radio" name="model" value="modelo-2">
                  <div class="model-preview">
                    <div class="preview-front">Frente</div>
                    <div class="preview-back">Espalda</div>
                  </div>
                  <span>Modelo 2</span>
                </label>
                <label class="model-card" data-model="modelo-3">
                  <input type="radio" name="model" value="modelo-3">
                  <div class="model-preview">
                    <div class="preview-front">Frente</div>
                    <div class="preview-back">Espalda</div>
                  </div>
                  <span>Modelo 3</span>
                </label>
              </div>
              <!-- Visor expandido de modelo seleccionado -->
              <div id="modelViewer" class="model-viewer" style="display:none;margin-top:2rem;">
                <button type="button" class="close-viewer" onclick="document.getElementById('modelViewer').style.display='none'">×</button>
                <div class="viewer-content">
                  <div class="viewer-side">
                    <h5>Frente</h5>
                    <div class="viewer-image">Frente</div>
                  </div>
                  <div class="viewer-side">
                    <h5>Espalda</h5>
                    <div class="viewer-image">Espalda</div>
                  </div>
                </div>
              </div>
            </fieldset>

            <!-- Talla y cantidad -->
            <fieldset class="form-section">
              <legend>Detalles del pedido</legend>
              <div class="form-row">
                <div class="form-group">
                  <label for="size">Talla</label>
                  <select id="size" name="size" required>
                    <option value="">Selecciona talla</option>
                    <option value="XS">XS</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                    <option value="XXL">XXL</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="quantity">Cantidad</label>
                  <input type="number" id="quantity" name="quantity" min="1" max="50" value="1" required>
                </div>
              </div>
            </fieldset>

            <!-- Datos personales -->
            <fieldset class="form-section">
              <legend>Tus datos</legend>
              <div class="form-group">
                <label for="name">Nombre completo</label>
                <input type="text" id="name" name="name" required placeholder="Tu nombre">
              </div>
              <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required placeholder="tu@email.com" title="Introduce un email válido">
              </div>
            </fieldset>

            <button type="submit" class="submit-btn">Confirmar reserva</button>
          </form>

          <!-- Mensaje de confirmación (oculto por defecto) -->
          <div id="confirmationMessage" class="confirmation-message" style="display:none;">
            <div class="confirmation-content">
              <h4>✓ Reserva confirmada</h4>
              <p>Tu pedido ha sido registrado correctamente.</p>
              <p><strong id="confirmationDetails"></strong></p>
              <p class="muted">Recibirás más detalles en tu email.</p>
              <button class="reset-btn" onclick="document.getElementById('tshirtForm').reset(); document.getElementById('confirmationMessage').style.display='none'; document.getElementById('tshirtForm').style.display='block';">Hacer otra reserva</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>
        <strong>Rizoma</strong>
        <p class="muted">Celebrando la Primavera — comunidad & naturaleza</p>
      </div>
      <div class="footer-right">
        <p class="muted">
          <a href="https://www.instagram.com/rizoma.moron/" target="_blank" rel="noopener noreferrer" class="social-link">Síguenos en Instagram</a>
        </p>
      </div>
    </div>
  </footer>

  <script>
    // ============ FORMULARIO CAMISETAS ============
    const tshirtForm = document.getElementById('tshirtForm');
    const confirmationMessage = document.getElementById('confirmationMessage');
    const modelCards = document.querySelectorAll('.model-card');
    const modelViewer = document.getElementById('modelViewer');

    // Evento para abrir visor de modelo
    modelCards.forEach(card => {
      card.addEventListener('click', (e) => {
        // No abrir si es un clic en el radio input
        if (e.target.type === 'radio') return;
        
        const modelName = card.dataset.model;
        const modelLabel = card.querySelector('span').textContent;
        
        // Actualizar contenido del visor
        const viewer = `
          <div class="viewer-content">
            <div class="viewer-side">
              <h5>Frente - ${modelLabel}</h5>
              <div class="viewer-image">Frente del modelo</div>
            </div>
            <div class="viewer-side">
              <h5>Espalda - ${modelLabel}</h5>
              <div class="viewer-image">Espalda del modelo</div>
            </div>
          </div>
        `;
        
        modelViewer.innerHTML = `
          <button type="button" class="close-viewer" onclick="document.getElementById('modelViewer').style.display='none'">×</button>
          ${viewer}
        `;
        modelViewer.style.display = 'block';
      });
    });

    // Validación de email
    const emailInput = document.getElementById('email');
    emailInput.addEventListener('change', () => {
      if (!emailInput.validity.valid) {
        emailInput.classList.add('error');
      } else {
        emailInput.classList.remove('error');
      }
    });

    tshirtForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Validar email
      if (!emailInput.validity.valid) {
        alert('Por favor introduce un email válido');
        return;
      }

      const formData = {
        timestamp: new Date().toISOString(),
        model: document.querySelector('input[name="model"]:checked').value,
        size: document.getElementById('size').value,
        quantity: document.getElementById('quantity').value,
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
      };

      // URL del Google Apps Script (reemplaza con tu URL)
      const SCRIPT_URL = 'https://script.google.com/macros/d/YOUR_SCRIPT_ID/usercallback';

      try {
        // Envío a Google Sheets
        const response = await fetch(SCRIPT_URL, {
          method: 'POST',
          mode: 'no-cors',
          body: JSON.stringify(formData),
        });

        // Mostrar confirmación
        document.getElementById('confirmationDetails').textContent = 
          `${formData.quantity} camiseta(s) - Modelo ${formData.model.split('-')[1]} - Talla ${formData.size}`;
        
        tshirtForm.style.display = 'none';
        confirmationMessage.style.display = 'block';

      } catch (error) {
        console.error('Error:', error);
        alert('Hubo un error en la reserva. Por favor intenta de nuevo.');
      }
    });
  </script>
</body>
</html>
